# Azure Configuration (for Graph API)
# For local dev: use these env vars directly
# For production: set AZURE_KEY_VAULT_NAME and secrets will be loaded from Key Vault
AZURE_TENANT_ID=your-tenant-id
AZURE_CLIENT_ID=your-client-id
AZURE_CLIENT_SECRET=your-client-secret

# Azure Key Vault (REQUIRED in production)
# When set, secrets are loaded from Key Vault instead of env vars
# AZURE_KEY_VAULT_NAME=kv-phishing-agent-dev

# Azure Authentication Method
# 'secret' = Use client secret (default for development)
# 'managed-identity' = Use Managed Identity (default for production)
# AZURE_AUTH_METHOD=secret

# Sender Allowlist (REQUIRED in production - fail-closed)
# Comma-separated list of allowed email addresses and/or domains
# At least one must be configured in production, otherwise all senders are blocked
# ALLOWED_SENDER_EMAILS=user@trusted.com,admin@company.com
# ALLOWED_SENDER_DOMAINS=company.com,partner.org

# Mailbox Monitoring
PHISHING_MAILBOX_ADDRESS=phishing@yourdomain.com
MAILBOX_CHECK_INTERVAL_MS=60000
MAILBOX_MONITOR_ENABLED=true
MAILBOX_MAX_PAGES=5
MAILBOX_PARALLEL_LIMIT=5

# Server Configuration
PORT=3000
NODE_ENV=development

# HTTP Security
HTTP_BODY_LIMIT=100kb
HELMET_ENABLED=true
HEALTH_CACHE_TTL_MS=30000

# API Authentication (REQUIRED in production)
# API_KEY=your-secure-api-key
# HEALTH_API_KEY=your-health-api-key
# METRICS_API_KEY=your-metrics-api-key

# Redis Configuration (optional - for multi-replica deployments)
# When set, rate limiting and deduplication are distributed across replicas
# REDIS_URL=rediss://your-redis.redis.cache.windows.net:6380
# REDIS_KEY_PREFIX=phishing-agent:

# Threat Intelligence APIs (optional but recommended)
VIRUSTOTAL_API_KEY=your-virustotal-key
ABUSEIPDB_API_KEY=your-abuseipdb-key
URLSCAN_API_KEY=your-urlscan-key

# Threat Intel Settings
THREAT_INTEL_ENABLED=true
THREAT_INTEL_TIMEOUT_MS=5000
THREAT_INTEL_CACHE_TTL_MS=300000

# Rate Limiting (prevents email sending abuse)
RATE_LIMIT_ENABLED=true
MAX_EMAILS_PER_HOUR=100
MAX_EMAILS_PER_DAY=1000
CIRCUIT_BREAKER_THRESHOLD=50
CIRCUIT_BREAKER_WINDOW_MS=600000

# Email Deduplication (prevents duplicate replies)
DEDUPLICATION_ENABLED=true
DEDUPLICATION_TTL_MS=86400000
SENDER_COOLDOWN_MS=86400000

# LLM-Enhanced Analysis (optional - for natural language explanations)
# ANTHROPIC_API_KEY=sk-ant-api03-...
# LLM_DEMO_MODE=false  # Set to 'true' to run LLM on all emails (demo purposes)
